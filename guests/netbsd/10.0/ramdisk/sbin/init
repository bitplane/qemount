#!/bin/sh
export PATH=/bin:/sbin

# Mount tmpfs at /dev so we can create device nodes
mount -t tmpfs tmpfs /dev

# Create device nodes
# console=0,0  tty00/com0=8,0  null=2,2
mknod /dev/console c 0 0
mknod /dev/tty00 c 8 0
mknod /dev/null c 2 2

# Redirect to serial console
exec >/dev/tty00 2>&1 </dev/tty00

echo ""
echo "==================================="
echo "  NetBSD qemount guest starting"
echo "==================================="
echo ""

# Interactive shell - restart if it exits
while :; do
    echo "Starting shell..."
    /bin/sh -i
    echo "Shell exited, restarting..."
    sleep 1
done
