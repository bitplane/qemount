#!/bin/sh
set -eu

if [ -e "$PORT_PATH" ]; then
    echo "[INFO] Starting 9P server..."
    # u9fs serves from stdin/stdout, so we redirect the virtio port to it
    u9fs -a none -u $(whoami) "$MOUNT_POINT" < "$PORT_PATH" > "$PORT_PATH" &
else
    echo "[ERROR] 9P port path not found: $PORT_PATH"
fi